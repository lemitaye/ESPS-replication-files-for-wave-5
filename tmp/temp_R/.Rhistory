mean_kabuli_w5_hh,
mean_kabuli_w5_ea
) %>%
mutate(region = fct_relevel(region, "Amhara", "Oromia", "SNNP", "Other regions", "National"))
kabuli_plot <- kabuli_bind %>%
filter(level == "Household-level", region != "Tigray") %>%
ggplot(aes(region, mean_chickpea, fill = wave)) +
geom_col(position = "dodge") +
geom_text(aes(label = paste0( round(mean_chickpea*100, 1), "%", "\n(", nobs, ")" ) ),
position = position_dodge(width = 1),
vjust = -.35, size = 2.5) +
facet_wrap(~ level, scales = "free") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_y_continuous(labels = percent_format()) +
expand_limits(y = .15) +
theme(legend.position = "top") +
labs(x = "", y = "Percent",
title = "Comparision of Adoption of Chickpea Kabuli Variety b/n Waves 3 and 5",
fill = "",
caption = "Percent are weighted sample means.
Number of responding households in parenthesis")
ggsave(
filename = file.path(root, "LSMS_W5/tmp/figures/kabuli_plot.pdf"),
plot = kabuli_plot,
device = cairo_pdf,
width = 180,
height = 135,
units = "mm"
)
# Comparing crop-germplasm improvements
ess4_dna_hh_new <- read_dta(file.path(root, w4_dir, "ess4_dna_hh_new.dta")) %>%
filter(!is.na(maize_cg), !is.na(dtmz)) %>%  # retain only maize
select(-barley_cg, -sorghum_cg) %>%
recode_region()
ess5_dna_hh_new <- read_dta(file.path(root, w5_dir, "ess5_dna_hh_new.dta")) %>%
recode_region()
dna_means <- bind_rows(
ess4_dna_hh_new %>%
group_by(region) %>%
summarise(
mean_maize = weighted.mean(maize_cg, w = pw_w4, na.rm = TRUE),
mean_dtmz = weighted.mean(dtmz, w = pw_w4, na.rm = TRUE),
nobs = sum(!is.na(maize_cg))
) %>%
mutate(wave = "Wave 4"),
ess4_dna_hh_new %>%
summarise(
mean_maize = weighted.mean(maize_cg, w = pw_w4, na.rm = TRUE),
mean_dtmz = weighted.mean(dtmz, w = pw_w4, na.rm = TRUE),
nobs = sum(!is.na(maize_cg))
) %>%
mutate(region = "National", wave = "Wave 4"),
ess5_dna_hh_new %>%
group_by(region) %>%
summarise(
mean_maize = weighted.mean(maize_cg, w = pw_w5, na.rm = TRUE),
mean_dtmz = weighted.mean(dtmz, w = pw_w5, na.rm = TRUE),
nobs = sum(!is.na(maize_cg))
) %>%
mutate(wave = "Wave 5"),
ess5_dna_hh_new %>%
summarise(
mean_maize = weighted.mean(maize_cg, w = pw_w5, na.rm = TRUE),
mean_dtmz = weighted.mean(dtmz, w = pw_w5, na.rm = TRUE),
nobs = sum(!is.na(maize_cg))
) %>%
mutate(region = "National", wave = "Wave 5")
) %>%
pivot_longer(c("mean_maize", "mean_dtmz"),
names_to = "improvment",
values_to = "mean") %>%
mutate(region = fct_relevel(
region,
"Tigray", "Amhara", "Oromia", "SNNP", "Other regions", "National"
))
plot_dna <- function(tbl, ylim) {
tbl %>%
filter(region != "Tigray") %>%
ggplot(aes(region, mean, fill = wave)) +
geom_col(position = "dodge") +
geom_text(aes(label = paste0( round(mean*100, 2), "%", "\n(", nobs, ")" ) ),
position = position_dodge(width = 1),
vjust = -.35, size = 2.5) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_y_continuous(labels = percent_format()) +
expand_limits(y = ylim) +
labs(x = "", y = "Percent", fill = "")
}
maize_plot <- dna_means %>%
filter(improvment == "mean_maize") %>%
plot_dna(ylim = 1) +
labs(title = "Maize - CG germplasm")
dtmz_plot <- dna_means %>%
filter(improvment == "mean_dtmz") %>%
plot_dna(ylim = .6) +
labs(title = "Drought tolerant maize",
caption = "Percent are weighted sample means.
Number of responding households in parenthesis")
maize_dna <- ggarrange(
maize_plot, dtmz_plot,
nrow = 2,
common.legend = TRUE
)
ggsave(
filename = file.path(root, "LSMS_W5/tmp/figures/maize_dna_plot.pdf"),
plot = maize_dna,
device = cairo_pdf,
width = 185,
height = 285,
scale = .8,
units = "mm"
)
# panel dna households:
inner_join(
ess4_dna_hh_new,
ess5_dna_hh_new,
by = "household_id",
suffix = c("_w4", "_w5")
)
# Synergies: comparing joint adoption rates
synergies_hh_ess5_new <- read_dta(file.path(root, w5_dir, "synergies_hh_ess5_new.dta"))
synergies_hh_ess4_new <- read_dta(file.path(root, w4_dir, "synergies_hh_ess4_new.dta"))
# Maize - DNA data
synergies_dna_hh_ess4 <- read_dta(file.path(root, w4_dir, "synergies_dna_hh_ess4.dta")) %>%
filter(!is.na(maize_cg))   # filter maize only
synergies_dna_hh_ess5 <- read_dta(file.path(root, w5_dir, "synergies_dna_hh_ess5.dta"))
vars <- unique(c(
"nrm", "ca", "nrm_ca", "nrm", "ca1", "nrm_ca1", "nrm", "ca2", "nrm_ca2", "nrm", "ca3",
"nrm_ca3", "nrm", "ca4", "nrm_ca4", "nrm", "ca5", "nrm_ca5", "nrm", "crop", "nrm_crop",
"nrm", "tree", "nrm_tree", "nrm", "animal", "nrm_animal", "nrm", "breed", "nrm_breed",
"nrm", "breed2", "nrm_breed2", "nrm", "psnp", "nrm_psnp", "nrm", "rotlegume", "nrm_rotlegume",
"nrm", "cresidue", "nrm_cresidue", "nrm", "mintillage", "nrm_mintillage", "nrm", "zerotill",
"nrm_zerotill", "ca", "crop", "ca_crop", "ca", "tree", "ca_tree", "ca", "animal", "ca_animal",
"ca", "breed", "ca_breed", "ca", "breed2", "ca_breed2", "ca", "psnp", "ca_psnp", "crop", "tree",
"crop_tree", "crop", "animal", "crop_animal", "crop", "breed", "crop_breed", "crop", "breed2",
"crop_breed2", "crop", "psnp", "crop_psnp", "crop", "rotlegume", "crop_rotlegume", "crop", "cresidue",
"crop_cresidue", "crop", "mintillage", "crop_mintillage", "crop", "zerotill", "crop_zerotill",
"crop", "ca1", "crop_ca1", "crop", "ca2", "crop_ca2", "crop", "ca3", "crop_ca3", "crop", "ca4",
"crop_ca4", "crop", "ca5", "crop_ca5", "tree", "animal", "tree_animal", "tree", "breed", "tree_breed",
"tree", "breed2", "tree_breed2", "tree", "psnp", "tree_psnp", "tree", "rotlegume", "tree_rotlegume",
"tree", "cresidue", "tree_cresidue", "tree", "mintillage", "tree_mintillage", "tree", "zerotill",
"tree_zerotill", "tree", "ca1", "tree_ca1", "tree", "ca2", "tree_ca2", "tree", "ca3", "tree_ca3",
"tree", "ca4", "tree_ca4", "tree", "ca5", "tree_ca5", "animal", "breed", "animal_breed", "animal",
"breed2", "animal_breed2", "animal", "psnp", "animal_psnp", "animal", "rotlegume", "animal_rotlegume",
"animal", "cresidue", "animal_cresidue", "animal", "mintillage", "animal_mintillage", "animal", "zerotill",
"animal_zerotill", "animal", "ca1", "animal_ca1", "animal", "ca2", "animal_ca2", "animal", "ca3", "animal_ca3",
"animal", "ca4", "animal_ca4", "animal", "ca5", "animal_ca5", "breed", "psnp", "breed_psnp", "breed", "rotlegume",
"breed_rotlegume", "breed", "cresidue", "breed_cresidue", "breed", "mintillage", "breed_mintillage", "breed",
"zerotill", "breed_zerotill", "breed", "ca1", "breed_ca1", "breed", "ca2", "breed_ca2", "breed", "ca3", "breed_ca3",
"breed", "ca4", "breed_ca4", "breed", "ca5", "breed_ca5", "breed2", "psnp", "breed2_psnp", "breed2", "rotlegume",
"breed2_rotlegume", "breed2", "cresidue", "breed2_cresidue", "breed2", "mintillage", "breed2_mintillage", "breed2",
"zerotill", "breed2_zerotill", "breed2", "ca1", "breed2_ca1", "breed2", "ca2", "breed2_ca2", "breed2", "ca3",
"breed2_ca3", "breed2", "ca4", "breed2_ca4", "breed2", "ca5", "breed2_ca5", "psnp", "rotlegume", "psnp_rotlegume",
"psnp", "cresidue", "psnp_cresidue", "psnp", "mintillage", "psnp_mintillage", "psnp", "zerotill", "psnp_zerotill",
"psnp", "ca1", "psnp_ca1", "psnp", "ca2", "psnp_ca2", "psnp", "ca3", "psnp_ca3", "psnp", "ca4", "psnp_ca4", "psnp",
"ca5", "psnp_ca5", "rotlegume", "cresidue", "rotlegume_cresidue", "rotlegume", "mintillage", "rotlegume_mintillage",
"rotlegume", "zerotill", "rotlegume_zerotill", "cresidue", "mintillage", "cresidue_mintillage", "cresidue", "zerotill",
"cresidue_zerotill"
))
vars_joint <- vars[str_detect(vars, "_")]
vars_maize <- c(
"nrm_maize", "ca_maize", "crop_maize", "tree_maize", "animal_maize", "breed_maize", "breed2_maize",
"psnp_maize", "rotlegume_maize", "cresidue_maize", "mintillage_maize", "zerotill_maize"
)
lbl_vars <- c(
var_label(select(synergies_hh_ess5_new, all_of(vars_joint))),
var_label(select(synergies_dna_hh_ess5, all_of(vars_maize)))
) %>%
as_tibble() %>%
pivot_longer(
cols = everything(),
names_to = "variable",
values_to = "label"
) %>%
mutate(label = str_replace(label, " - ", " & "))
joint_rate <- function(tbl, pw, vars, wave_no) {
tbl %>%
summarise(
across(all_of(vars), ~weighted.mean(., w={{pw}}, na.rm = TRUE))
) %>%
mutate(wave = wave_no) %>%
pivot_longer(cols = -wave, names_to = "variable", values_to = "joint_rate")
}
joint_rate_tbl <- bind_rows(
joint_rate(synergies_hh_ess5_new, pw_w5, vars_joint, "Wave 5"),
joint_rate(synergies_hh_ess4_new, pw_w4, vars_joint, "Wave 4"),
joint_rate(synergies_dna_hh_ess5, pw_w5, vars_maize, "Wave 5"),
joint_rate(synergies_dna_hh_ess4, pw_w4, vars_maize, "Wave 4")
) %>%
left_join(lbl_vars, by = "variable") %>%
filter(complete.cases(.)) %>%
filter(!str_detect(label, "CA1|CA2|CA3|CA4|CA5")) %>%
mutate(
label = str_replace(label, "Maize - CG germplasm", "Maize-CG"),
label = str_replace(label, "Feed and Forages", "Forages"),
label = str_trim(label)
)
# only panel households
synergies_hh_ess5_panel <- semi_join(
x = synergies_hh_ess5_new,
y = synergies_hh_ess4_new,
by = "household_id"
)
synergies_hh_ess4_panel <- semi_join(
x = synergies_hh_ess4_new,
y = synergies_hh_ess5_new,
by = "household_id"
)
synergies_dna_hh_ess5_panel <- semi_join(
x = synergies_dna_hh_ess5,
y = synergies_dna_hh_ess4,
by = "household_id"
)
synergies_dna_hh_ess4_panel <- semi_join(
x = synergies_dna_hh_ess4,
y = synergies_dna_hh_ess5,
by = "household_id"
)
joint_rate_tbl_panel <- bind_rows(
joint_rate(synergies_hh_ess5_panel, pw_w5, vars_joint, "Wave 5"),
joint_rate(synergies_hh_ess4_panel, pw_w4, vars_joint, "Wave 4"),
joint_rate(synergies_dna_hh_ess5_panel, pw_w5, vars_maize, "Wave 5"),
joint_rate(synergies_dna_hh_ess4_panel, pw_w4, vars_maize, "Wave 4")
) %>%
left_join(lbl_vars, by = "variable") %>%
filter(complete.cases(.)) %>%
filter(!str_detect(label, "CA1|CA2|CA3|CA4|CA5")) %>%
mutate(
label = str_replace(label, "Maize - CG germplasm", "Maize-CG"),
label = str_replace(label, "Feed and Forages", "Forages"),
label = str_trim(label)
)
source("C:/Users/l.daba/OneDrive/SPIA/Ethiopia/LSMS_W5/tmp/temp_R/figs_hh.R", echo=TRUE)
install.packages("thatssorandom")
source("C:/Users/l.daba/OneDrive/SPIA/Ethiopia/LSMS_W5/tmp/temp_R/figs_hh.R", echo=TRUE)
source("C:/Users/l.daba/OneDrive/SPIA/Ethiopia/LSMS_W5/tmp/temp_R/figs_hh.R", echo=TRUE)
wave5_hh_new
wave5_hh_new %>% glimpse()
source("C:/Users/l.daba/OneDrive/SPIA/Ethiopia/LSMS_W5/tmp/temp_R/figs_hh.R", echo=TRUE)
hh_level_w4
wave5_hh_new
wave5_hh_new %>% glimpse()
hh_level_w5 <- wave5_hh_new %>%
select(household_id, wave, region, pw_w5, pw_panel, all_of(vars_both)) %>%
recode_region()
hh_level_panel <- inner_join(
x = hh_level_w4 %>% select(-wave, -region),
y = hh_level_w5 %>% select(-wave),
by = "household_id",
suffix = c(".w4", ".w5")
) %>%
select(household_id, region, pw_panel, everything()) %>%
pivot_longer(hhd_ofsp.w4:hhd_rotlegume.w5,
names_to = "variable",
values_to = "value") %>%
separate(variable, into = c("variable", "wave"), sep = "\\.") %>%
mutate(wave = recode(wave, "w4" = "Wave 4", "w5" = "Wave 5")) %>%
left_join(labels, by = "variable")
inner_join(
x = hh_level_w4 %>% select(-wave, -region),
y = hh_level_w5 %>% select(-wave),
by = "household_id",
suffix = c(".w4", ".w5")
) %>%
select(household_id, region, pw_panel, everything()) %>%
pivot_longer(hhd_ofsp.w4:hhd_rotlegume.w5,
names_to = "variable",
values_to = "value")
inner_join(
x = hh_level_w4 %>% select(-wave, -region),
y = hh_level_w5 %>% select(-wave),
by = "household_id",
suffix = c(".w4", ".w5")
) %>%
select(household_id, region, pw_panel, everything()) %>%
pivot_longer(hhd_ofsp.w4:hhd_rotlegume.w5,
names_to = "variable",
values_to = "value") %>%
separate(variable, into = c("variable", "wave"), sep = "\\.")
inner_join(
x = hh_level_w4 %>% select(-wave, -region),
y = hh_level_w5 %>% select(-wave),
by = "household_id",
suffix = c(".w4", ".w5")
)
inner_join(
x = hh_level_w4 %>% select(-wave, -region),
y = hh_level_w5 %>% select(-wave),
by = "household_id",
suffix = c(".w4", ".w5")
) %>% glimpse()
inner_join(
x = hh_level_w4 %>% select(-wave, -region),
y = hh_level_w5 %>% select(-wave),
by = "household_id",
suffix = c(".w4", ".w5")
) %>% glimpse()
select(household_id, region, pw_panel, everything())
inner_join(
x = hh_level_w4 %>% select(-wave, -region),
y = hh_level_w5 %>% select(-wave),
by = "household_id",
suffix = c(".w4", ".w5")
) %>%
select(household_id, region, pw_panel, everything())
inner_join(
x = hh_level_w4 %>% select(-wave, -region),
y = hh_level_w5 %>% select(-wave),
by = "household_id",
suffix = c(".w4", ".w5")
) %>%
select(household_id, region, pw_panel, everything()) %>% glimpse()
inner_join(
x = hh_level_w4 %>% select(-wave, -region),
y = hh_level_w5 %>% select(-wave),
by = "household_id",
suffix = c(".w4", ".w5")
) %>%
select(household_id, region, pw_panel, everything()) %>%
pivot_longer(hhd_ofsp.w4:hhd_rotlegume.w5,
names_to = "variable",
values_to = "value")
inner_join(
x = hh_level_w4 %>% select(-wave, -region),
y = hh_level_w5 %>% select(-wave),
by = "household_id",
suffix = c(".w4", ".w5")
) %>%
select(household_id, region, pw_w4, pw_w5, pw_panel, everything()) %>%
pivot_longer(hhd_ofsp.w4:hhd_rotlegume.w5,
names_to = "variable",
values_to = "value")
inner_join(
x = hh_level_w4 %>% select(-wave, -region),
y = hh_level_w5 %>% select(-wave),
by = "household_id",
suffix = c(".w4", ".w5")
) %>%
select(household_id, region, pw_w4, pw_w5, pw_panel, everything()) %>%
pivot_longer(hhd_ofsp.w4:hhd_rotlegume.w5,
names_to = "variable",
values_to = "value") %>%
separate(variable, into = c("variable", "wave"), sep = "\\.")
hh_level_panel <- inner_join(
x = hh_level_w4 %>% select(-wave, -region),
y = hh_level_w5 %>% select(-wave),
by = "household_id",
suffix = c(".w4", ".w5")
) %>%
select(household_id, region, pw_w4, pw_w5, pw_panel, everything()) %>%
pivot_longer(hhd_ofsp.w4:hhd_rotlegume.w5,
names_to = "variable",
values_to = "value") %>%
separate(variable, into = c("variable", "wave"), sep = "\\.") %>%
mutate(wave = recode(wave, "w4" = "Wave 4", "w5" = "Wave 5")) %>%
left_join(labels, by = "variable")
regions_hh_panel <- hh_level_panel %>%
group_by(wave, region, label) %>%
summarise(
mean = weighted.mean(value, w = pw_panel, na.rm = TRUE),
nobs = sum(!is.na(value)),
.groups = "drop"
) %>%
mutate(improv = case_when(
str_detect(label, "Improved") ~ 1,
TRUE ~ 0
))
national_hh_panel <- hh_level_panel %>%
group_by(wave, label) %>%
summarise(
mean = weighted.mean(value, w = pw_panel, na.rm = TRUE),
nobs = sum(!is.na(value)),
.groups = "drop"
) %>%
mutate(improv = case_when(
str_detect(label, "Improved") ~ 1,
TRUE ~ 0
))
plot_compar <- function(tbl, title, xlim = .8) {
tbl %>%
mutate(
improv = case_when(
str_detect(label, "Improved") ~ 1,
TRUE ~ 0
),
wave = fct_relevel(wave, "Wave 5", "Wave 4"),
label = fct_reorder(label, -improv)
) %>%
ggplot(aes(mean, label, fill = wave)) +
geom_col(position = "dodge") +
geom_text(aes(label = paste0( round(mean*100, 2), "%", " (", nobs, ")" ) ),
position = position_dodge(width = 1),
hjust = -.15, size = 2.5) +
scale_y_discrete(labels = function(x) str_wrap(x, width = 35)) +
scale_x_continuous(labels = percent_format()) +
expand_limits(x = xlim) +
theme(legend.position = "top") +
labs(x = "Percent of households",
y = "",
fill = "",
title = paste0("Percent of Rural Households Adopting Innovations - ", title),
caption = "Percent are weighted sample means using the latest (wave 5) weights.
Number of households responding in parenthesis")
}
nat_hh <- national_hh_level %>%
plot_compar("National", xlim = .85)
nat_hh
nat_panel <- national_hh_panel %>%
plot_compar("National") +
labs(subtitle = "Only panel households included")
nat_panel
source("C:/Users/l.daba/OneDrive/SPIA/Ethiopia/LSMS_W5/tmp/temp_R/figs_hh.R", echo=TRUE)
source("C:/Users/l.daba/OneDrive/SPIA/Ethiopia/LSMS_W5/tmp/temp_R/figs_hh.R", echo=TRUE)
ggsave(
filename = file.path(root, "LSMS_W5/tmp/figures/kabuli_plot.pdf"),
plot = kabuli_plot,
device = cairo_pdf,
width = 180,
height = 135,
units = "mm"
)
source("C:/Users/l.daba/OneDrive/SPIA/Ethiopia/LSMS_W5/tmp/temp_R/figs_ea.R", echo=TRUE)
source("C:/Users/l.daba/OneDrive/SPIA/Ethiopia/LSMS_W5/tmp/temp_R/figs_ea.R", echo=TRUE)
source("C:/Users/l.daba/OneDrive/SPIA/Ethiopia/LSMS_W5/tmp/temp_R/figs_ea.R", echo=TRUE)
source("C:/Users/l.daba/OneDrive/SPIA/Ethiopia/LSMS_W5/tmp/temp_R/dynamics_plots_esps.R", echo=TRUE)
source("C:/Users/l.daba/OneDrive/SPIA/Ethiopia/LSMS_W5/tmp/temp_R/dynamics_plots_esps.R", echo=TRUE)
source("C:/Users/l.daba/OneDrive/SPIA/Ethiopia/LSMS_W5/tmp/temp_R/dynamics_plots_esps.R", echo=TRUE)
source("~/ggplot_theme_Publication-2.R")
source("~ggplot_theme_Publication-2.R")
source("ggplot_theme_Publication-2.R")
source("~/ggplot_theme_Publication-2.R")
source("C:/Users/l.daba/OneDrive/SPIA/Ethiopia/LSMS_W5/tmp/temp_R/ggplot_theme_Publication-2.R")
source("C:/Users/l.daba/OneDrive/SPIA/Ethiopia/LSMS_W5/tmp/temp_R/dynamics_plots_esps.R", echo=TRUE)
nat_hh
nat_hh <- national_hh_level %>%
plot_compar("National", xlim = .85) +
labs(caption = "Percent are weighted sample means using panel weights.
Number of households responding in parenthesis")
nat_hh
national_hh_level
nat_hh <- national_hh_level %>%
plot_compar("National", xlim = .85) +
labs(caption = "Percent are weighted sample means using each wave's respective weights.
Number of households responding in parenthesis")
amhara_hh <- regions_hh_level %>%
filter(region == "Amhara") %>%
plot_compar("Amhara", xlim = 1.05) +
labs(caption = "Percent are weighted sample means using each wave's respective weights.
Number of households responding in parenthesis")
oromia_hh <- regions_hh_level %>%
filter(region == "Oromia") %>%
plot_compar("Oromia") +
labs(caption = "Percent are weighted sample means using each wave's respective weights.
Number of households responding in parenthesis")
snnp_hh <- regions_hh_level %>%
filter(region == "SNNP") %>%
plot_compar("SNNP") +
labs(caption = "Percent are weighted sample means using each wave's respective weights.
Number of households responding in parenthesis")
other_hh <- regions_hh_level %>%
filter(region == "Other regions") %>%
plot_compar("Other regions") +
labs(caption = "Percent are weighted sample means using each wave's respective weights.
Number of households responding in parenthesis")
plots <- list(nat_hh, amhara_hh, oromia_hh, snnp_hh, other_hh,
nat_panel, amhara_panel, oromia_panel, snnp_panel, other_panel)
names(plots) <- c("nat_hh", "amhara_hh", "oromia_hh", "snnp_hh", "other_hh", "nat_panel",
"amhara_panel", "oromia_panel", "snnp_panel", "other_panel")
for (i in seq_along(plots)) {
file <- paste0(root, "/LSMS_W5/tmp/figures/", names(plots)[[i]], ".pdf")
print(paste("saving to", file))
ggsave(
filename = file,
plot = plots[[i]],
device = cairo_pdf,
width = 200,
height = 285,
units = "mm"
)
}
animal_dyn_plt <- animal_agri %>%
mutate(label = str_to_sentence(label)) %>%
ggplot(aes(label, mean, fill = wave)) +
geom_col(position = "dodge") +
geom_text(aes(label = paste0( round(mean*100, 1) ) ),
position = position_dodge(width = 1),
vjust = -.35, size = 3) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_y_continuous(labels = percent_format()) +
# expand_limits(y = .6) +
facet_wrap(~level, nrow = 1, scales = "free_y") +
labs(x = "", y = "Percent",
title = "Adoption of animal agriculture innovations (ESPS)",
fill = "",
caption = "Percent at the household level are weighted sample means using panel weights") +
scale_fill_Publication() +
theme_Publication() +
theme(
legend.position = "top",
legend.margin = margin(t = -0.4, unit = "cm"),
axis.title = element_text(size = 12.5),
plot.margin = unit(c(1, 1, 0.5, 1), units = "line") # top, right, bottom, & left
)
ggsave(
filename = "LSMS_W5/tmp/figures/animal_dyn_plt.pdf",
plot = animal_dyn_plt,
device = cairo_pdf,
width = 8,
height = 5#,
# scale = 1.2#,
# units = "mm"
)
